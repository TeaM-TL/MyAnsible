---
- name: 1 install repo Zabbix
  apt:
    deb: "{{ zabbix_url_deb }}"
    state: present

      #- name: 2 apt update
      #  apt:
      #    update_cache: yes
      #    cache_valid_time: 86400 # one day

- name: 2 install Zabbix agent
  apt:
    name: "{{ zabbix_agent_packages }}"
    update_cache: yes
    state: present
  when: zabbix_host == "agent"

- name: 3 install Zabbix server
  apt:
    name: "{{ zabbix_server_packages }}"
    update_cache: yes
    state: present
  when: zabbix_host == "server"

#- name: 2 new file ports.conf
#  copy:
#    src: "ports.conf"
#    dest: "/etc/apache2/ports.conf"
#    backup: true
#
#- name: 3 change port default virtualhost
#  lineinfile:
#    path: "/etc/apache2/sites-available/000-default.conf"
#    regexp: '<VirtualHost \*:80>'
#    line: '<VirtualHost *:8080>'
#    backup: true

#- name: create site dirs
#  file:
#    path: {{item}}
#    state: diretory

#- name: copy an index.html
#  template:
#    src: index.html.j2
#    dest: {{apache_docroot}}/index.html
#
#- name: copy an httpd.conf
#  template:
#    src: httpd.conf-{{ansible_os_family}}.j2
#    dest: {{apache_config}}
#    notify: restart apache

#- name: start apache
#  service:
#    name: httpd
#    state: started
#    enable: yes


